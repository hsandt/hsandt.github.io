<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Scales prototype in Unreal Engine | Long Nguyen Huu</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Scales prototype in Unreal Engine" />
<meta name="author" content="Long Nguyen Huu" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Note: this post has been moved from my old website. It is about UE4 and has not been tested for UE5, however most functions should be compatible." />
<meta property="og:description" content="Note: this post has been moved from my old website. It is about UE4 and has not been tested for UE5, however most functions should be compatible." />
<link rel="canonical" href="https://hsandt.github.io/devlog/2016/07/26/scales-prototype-in-unreal-engine.html" />
<meta property="og:url" content="https://hsandt.github.io/devlog/2016/07/26/scales-prototype-in-unreal-engine.html" />
<meta property="og:site_name" content="Long Nguyen Huu" />
<meta property="og:image" content="https://hsandt.github.io/assets/pictures/blog/devlog/2016-07-26/thumbnail.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-07-26T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://hsandt.github.io/assets/pictures/blog/devlog/2016-07-26/thumbnail.png" />
<meta property="twitter:title" content="Scales prototype in Unreal Engine" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Long Nguyen Huu"},"dateModified":"2016-07-26T00:00:00+00:00","datePublished":"2016-07-26T00:00:00+00:00","description":"Note: this post has been moved from my old website. It is about UE4 and has not been tested for UE5, however most functions should be compatible.","headline":"Scales prototype in Unreal Engine","image":"https://hsandt.github.io/assets/pictures/blog/devlog/2016-07-26/thumbnail.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://hsandt.github.io/devlog/2016/07/26/scales-prototype-in-unreal-engine.html"},"url":"https://hsandt.github.io/devlog/2016/07/26/scales-prototype-in-unreal-engine.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://hsandt.github.io/feed.xml" title="Long Nguyen Huu" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-TKEELY26NL"></script>
<script>
  window['ga-disable-G-TKEELY26NL'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TKEELY26NL');
</script>

</head>
<body>
<header class="site-header">

  <div class="wrapper"><div class="site-brand">
      <a class="site-title" rel="author" href="/">Long Nguyen Huu</a>
      <div class="site-subtitle">aka komehara – Game developer</div>
      <div class="social-links"><ul class="social-media-list">
<li>
  <a rel="me" href="https://komehara.itch.io/" target="_blank" title="My games on itch.io">
    
    
    <svg class="svg-icon icon-itchio">
      <use xlink:href="/assets/minima-social-icons.svg#itchio"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://github.com/hsandt" target="_blank" title="My GitHub repositories">
    
    
    <svg class="svg-icon icon-github">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://bitbucket.org/hsandt/" target="_blank" title="My BitBucket repositories">
    
    
    <svg class="svg-icon icon-bitbucket">
      <use xlink:href="/assets/minima-social-icons.svg#bitbucket"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://stackoverflow.com/users/3256073/hsandt" target="_blank" title="My profile on Stack Overflow">
    
    
    <svg class="svg-icon icon-stackoverflow">
      <use xlink:href="/assets/minima-social-icons.svg#stackoverflow"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://twitter.com/n_huulong" target="_blank" title="My posts on Twitter">
    
    
    <svg class="svg-icon icon-twitter">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://mastodon.gamedev.place/@leyn" target="_blank" title="My posts on Mastodon">
    
    
    <svg class="svg-icon icon-mastodon">
      <use xlink:href="/assets/minima-social-icons.svg#mastodon"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://www.youtube.com/channel/UCscc8AXbgMQCjzxsXLVvCsg" target="_blank" title="My videos on YouTube">
    
    
    <svg class="svg-icon icon-youtube">
      <use xlink:href="/assets/minima-social-icons.svg#youtube"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://www.linkedin.com/in/huulong/" target="_blank" title="My profile on LinkedIn">
    
    
    <svg class="svg-icon icon-linkedin">
      <use xlink:href="/assets/minima-social-icons.svg#linkedin"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://ko-fi.com/komehara" target="_blank" title="Donations on Ko-fi">
    
    
    <svg class="svg-icon icon-kofi">
      <use xlink:href="/assets/minima-social-icons.svg#kofi"></use>
    </svg>
  </a>
</li>
</ul>
</div>
    </div><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/portfolio/">Portfolio</a><a class="page-link" href="/blog/">Blog</a><a class="page-link" href="/writing/">Writing</a><a class="page-link" href="/comic-strips/">Comic strips</a><a class="page-link" href="/resume/">Resume</a><a class="page-link" href="/Resources/">Resources</a><a class="page-link" href="/newsletter/">Newsletter</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Scales prototype in Unreal Engine</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2016-07-26T00:00:00+00:00" itemprop="datePublished">
        Jul 26, 2016
      </time>
      
      <a href="/tags/ue4">
        #ue4
      </a><a href="/tags/blueprints">
        #blueprints
      </a>
    </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><em>Note: this post has been moved from my old website. It is about UE4 and has not been tested for UE5, however most functions should be compatible.</em></p>

<p>I made a prototype of <strong>giant scales</strong> for a third-person puzzle platformer I am developing with Unreal Engine. They are similar to the scales found in The Legend of Zelda: The Wind Waker in the Tower of the Gods, i.e. the side with the higher total weight goes down and the character has its own height. I worked with Blueprints but I intend to convert them to C++ for the final game.</p>

<p><img src="/assets/pictures/blog/devlog/2016-07-26/TP-Unreal-Scale-prototype-Character-and-all-blocks.png" alt="TP Unreal - Scale prototype Character and all blocks" /></p>

<h1 id="blueprints">Blueprints</h1>

<h2 id="scales">Scales</h2>

<p>Each scale acts as a platform on which the player character can stand. The scales move vertically depending on the difference of weights between the two scales.</p>

<p><img src="/assets/pictures/blog/devlog/2016-07-26/TP-Unreal-Scale-prototype-Blueprint-viewport.png" alt="TP Unreal - Scale prototype Blueprint viewport" /></p>

<h2 id="weight">Weight</h2>

<p>Each weight is a blueprint that inherits from a base <code class="language-plaintext highlighter-rouge">BP_Weight</code> class. They have one float parameter, their <strong>mass</strong> (in arbitrary unit), and have specific meshes so we can guess their masses at a glance. The Player character is not a <code class="language-plaintext highlighter-rouge">BP_Weight</code> itself, but in terms of mass it is equivalent to a tall block.</p>

<p>I wanted to detect weight located on top of a scale, but unfortunately Unreal does not send a specific event when a collider stops touching another (only <code class="language-plaintext highlighter-rouge">OnHit</code> when a contact starts). I didn’t want to rely on physics either, so I ended up using <code class="language-plaintext highlighter-rouge">OnBeginOverlap</code> and <code class="language-plaintext highlighter-rouge">OnEndOverlap</code> with very thin triggers I added on the surface of the platforms. Weights that enter the trigger are considered to be on top of the platform until they exit it. Not very elegant, but does the job.</p>

<p><img src="/assets/pictures/blog/devlog/2016-07-26/TP-Unreal-Scale-prototype-Blueprint-platform-trigger.png" alt="TP Unreal - Scale prototype Blueprint platform trigger" /></p>

<p>I needed to detect the Player character’s weight too, but character blueprints already have their own base class, so instead of using <code class="language-plaintext highlighter-rouge">BP_Weight</code> I added a manual check for the character (class <code class="language-plaintext highlighter-rouge">ThirdPersonCharacter</code>). So the blueprint tests for both <code class="language-plaintext highlighter-rouge">BP_Weight</code> and <code class="language-plaintext highlighter-rouge">ThirdPersonCharacter</code> in Overlap events.</p>

<p>[<img src="/assets/pictures/blog/devlog/2016-07-26/TP-Unreal-Scale-prototype-Blueprint-scale-overlap.png" alt="TP Unreal - Scale prototype Blueprint scale overlap" /></p>

<p><em>UPDATE 2025</em></p>

<p>The sub-graphs <strong>Attach to Platform</strong> and <strong>Detach to Platform</strong> are not shown here. They register/unregister weights put on a given platform. This is used to compute the weight difference and therefore the height difference in <strong>Update Target Delta Height</strong>, as described below.</p>

<h2 id="platform-motion">Platform motion</h2>

<p>Each time a new weight or the character stands on or leave one of the scales, I update the total mass on top of each scale. Then I compute the difference between the two values and multiply that by some factor to get the delta height of the scales, i.e. their new height relative to their height in the neutral position (the delta height is linear of weight difference).</p>

<p>For a smooth motion, I update the height of each scale gradually by playing a <strong>Timeline</strong> that returns a value between 0 and 1. I use the returned value in a linear interpolation (LERP) between the initial and the target height.</p>

<p><img src="/assets/pictures/blog/devlog/2016-07-26/TP-Unreal-Scale-prototype-Lift-Motion-Timeline.png" alt="TP Unreal - Scale prototype Lift Motion Timeline" /></p>

<p>Note that in Unreal Blueprints, timelines can only appear on the top-level event flow (probably because they rely on the   tick). If you want to play the timeline from inside a method as I did, you have to trigger an event in the method and bind that event to the Timeline node in the event flow.</p>

<h1 id="result">Result</h1>

<p>A demo of the scales in video:</p>

<video controls="">
  <source src="/assets/pictures/blog/devlog/2016-07-26/TP-Unreal-Scale-prototype-Demo.mp4" type="video/mp4" />
  Your browser does not support the video tag.
</video>

<h1 id="issues-and-future-improvements">Issues and future improvements</h1>

<p>An important issue with the Overlap method is that objects standing on top of another object on the platform are not detected. This is also true for the character. Have a look:</p>

<p><img src="/assets/pictures/blog/devlog/2016-07-26/TP-Unreal-Scale-prototype-Character-on-block-bug.png" alt="TP Unreal - Scale prototype Character on block bug" /></p>

<p>The character seems to have no weight since it is not detected by the platform box trigger.</p>

<p>To solve the problem mentioned above, we could either:</p>

<ul>
  <li>detect objects on top of other objects with multiple trigger overlap tests</li>
  <li>use a completely different approach (still thinking about it)</li>
</ul>

<p>Also, rather than using a base class <code class="language-plaintext highlighter-rouge">BP_Weight</code> for all weight objects, I could create an <strong>Actor Component</strong> for more flexibility. The Actor Component could then be added to any actor that should interact with the scales, including the Player character, without affecting its whole structure. Instead of casting objects detected by the scales, I would try to get that component. Note that Unreal Engine also provides Interfaces (not native in C++), but interfaces do not allow to define attributes such as a Mass.</p>

<h1 id="further-topic">Further topic</h1>

<p>I haven’t talked about the Zelda-like contextual actions Grab and Drop here. I need to improve them, maybe they will be the topic of another post.</p>

  </div><a class="u-url" href="/devlog/2016/07/26/scales-prototype-in-unreal-engine.html" hidden></a>
</article>

      </div>
    </main>
<footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        
        
        <ul class="contact-list">
          <li class="p-name">Long Nguyen Huu</li>
          <li><a class="u-email" href="mailto:n.huu.long@gmail.com">n.huu.long@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>This website was made with Jekyll and is hosted on GitHub Pages. It uses Google Analytics.</p>
        
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list">
<li>
  <a rel="me" href="https://komehara.itch.io/" target="_blank" title="My games on itch.io">
    
    
    <svg class="svg-icon icon-itchio">
      <use xlink:href="/assets/minima-social-icons.svg#itchio"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://github.com/hsandt" target="_blank" title="My GitHub repositories">
    
    
    <svg class="svg-icon icon-github">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://bitbucket.org/hsandt/" target="_blank" title="My BitBucket repositories">
    
    
    <svg class="svg-icon icon-bitbucket">
      <use xlink:href="/assets/minima-social-icons.svg#bitbucket"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://stackoverflow.com/users/3256073/hsandt" target="_blank" title="My profile on Stack Overflow">
    
    
    <svg class="svg-icon icon-stackoverflow">
      <use xlink:href="/assets/minima-social-icons.svg#stackoverflow"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://twitter.com/n_huulong" target="_blank" title="My posts on Twitter">
    
    
    <svg class="svg-icon icon-twitter">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://mastodon.gamedev.place/@leyn" target="_blank" title="My posts on Mastodon">
    
    
    <svg class="svg-icon icon-mastodon">
      <use xlink:href="/assets/minima-social-icons.svg#mastodon"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://www.youtube.com/channel/UCscc8AXbgMQCjzxsXLVvCsg" target="_blank" title="My videos on YouTube">
    
    
    <svg class="svg-icon icon-youtube">
      <use xlink:href="/assets/minima-social-icons.svg#youtube"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://www.linkedin.com/in/huulong/" target="_blank" title="My profile on LinkedIn">
    
    
    <svg class="svg-icon icon-linkedin">
      <use xlink:href="/assets/minima-social-icons.svg#linkedin"></use>
    </svg>
  </a>
</li>

<li>
  <a rel="me" href="https://ko-fi.com/komehara" target="_blank" title="Donations on Ko-fi">
    
    
    <svg class="svg-icon icon-kofi">
      <use xlink:href="/assets/minima-social-icons.svg#kofi"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer></body>

</html>
